{{- /* Builds /recipes/index.json containing ALL recipe pages */ -}}
{{- $pages := where .Site.RegularPages "Section" "recipes" -}}
{{- $pages = where $pages "Kind" "page" -}}

[
{{- range $i, $p := $pages -}}
  {{- if $i}},{{ end }}
  {
    "title": {{ $p.Title | jsonify }},
    "permalink": {{ $p.RelPermalink | jsonify }},
    "description": {{ with $p.Params.description }}{{ . | jsonify }}{{ else }}""{{ end }},
    "tags": {{ with $p.Params.tags }}{{ . | jsonify }}{{ else }}[]{{ end }},
    "servings": {{ with $p.Params.servings }}{{ . }}{{ else }}null{{ end }},
    "prepTime": {{ with $p.Params.prepTime }}{{ . | jsonify }}{{ else }}""{{ end }},
    "cookTime": {{ with $p.Params.cookTime }}{{ . | jsonify }}{{ else }}""{{ end }},
    "totalTime": {{ with $p.Params.totalTime }}{{ . | jsonify }}{{ else }}""{{ end }},
    "slot": {{ with $p.Params.slot }}{{ . }}{{ else }}null{{ end }}
  }
{{- end -}}
]
