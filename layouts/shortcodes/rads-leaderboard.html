{{- $recipes := where site.RegularPages "Section" "recipes" -}}
{{- $rows := slice -}}

{{- range $recipes -}}
  {{- $r := partial "rads-score.html" . -}}
  {{- $rows = $rows | append (dict
      "page" .
      "score" $r.score
      "scoreDisplay" $r.scoreDisplay
      "tier" $r.tier
      "label" $r.label
  ) -}}
{{- end -}}

{{- $sorted := sort $rows "score" "desc" -}}

<div class="rads-leaderboard">
  {{- range $sorted -}}
    <div class="rads-row">
      <div class="rads-row-title">
        <a href="{{ .page.RelPermalink }}">{{ .page.Title }}</a>

        <span class="rads-mini rads-tier-{{ .tier }}">
          ☢️ RADS {{ .scoreDisplay }} • {{ .label }}
        </span>
      </div>

      <div class="rads-row-meta">
        {{- with .page.Params.slot -}}<span class="rads-chip">Slot {{ . }}</span>{{- end -}}
        {{- with .page.Params.category -}}<span class="rads-chip">{{ . }}</span>{{- end -}}
      </div>
    </div>
  {{- end -}}
</div>
